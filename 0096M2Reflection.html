<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Coordination of Palliative Care – Reflection</title>
  <style>
    :root { --ink:#16324f; --line:#d8dee9; }
    body { font-family: Arial,Helvetica,sans-serif; margin:20px; color:#1f2937; }
    h2 { color:var(--ink); margin:0 0 8px; }
    p { margin:0 0 14px; }
    table { width:100%; border-collapse:collapse; table-layout:fixed; }
    th, td { border:1px solid var(--line); padding:10px; vertical-align:top; word-wrap:break-word; }
    th { background:#f7fafc; text-align:left; }
    .chips label { display:block; margin:4px 0; }
    textarea { width:100%; min-height:72px; }
    .actions { margin-top:16px; display:flex; gap:8px; flex-wrap:wrap; }
    button { padding:10px 14px; background:var(--ink); color:#fff; border:0; border-radius:8px; cursor:pointer; }
    button:hover { filter:brightness(1.05); }
    .small { font-size:12px; color:#475569; }
    @media (max-width: 768px) {
      table, thead, tbody, th, td, tr { display:block; width:100%; }
      th { position:relative; }
      tr { margin-bottom:16px; }
    }
  </style>
</head>
<body>
  <h2>Pause and reflect: Coordination of palliative care needs</h2>
  <p class="small">Select which cadres currently deliver each action, then add notes. Click <strong>Save answers</strong> first – then you will be able to download them as a text file.</p>

  <form id="form">
    <table role="table">
      <tr>
        <th>Action from Intervention 3</th>
        <th>Select trained health workers</th>
        <th>Your notes (training needed, gaps, ideas)</th>
      </tr>

      <!-- Row 1 -->
      <tr>
        <td><strong>Education & counselling for patients and caregivers</strong></td>
        <td class="chips" data-group="education">
          <label><input type="checkbox" value="Community health workers"> Community health workers</label>
          <label><input type="checkbox" value="Paramedical professionals"> Paramedical professionals</label>
          <label><input type="checkbox" value="Nurses"> Nurses</label>
          <label><input type="checkbox" value="General medical practitioners"> General medical practitioners</label>
          <label><input type="checkbox" value="Specialist medical practitioners"> Specialist medical practitioners</label>
          <label><input type="checkbox" value="Other"> Other</label>
        </td>
        <td><textarea data-notes="education"></textarea></td>
      </tr>

      <!-- Row 2 -->
      <tr>
        <td><strong>Caregiver training and support</strong></td>
        <td class="chips" data-group="caregiver">
          <label><input type="checkbox" value="Community health workers"> Community health workers</label>
          <label><input type="checkbox" value="Paramedical professionals"> Paramedical professionals</label>
          <label><input type="checkbox" value="Nurses"> Nurses</label>
          <label><input type="checkbox" value="General medical practitioners"> General medical practitioners</label>
          <label><input type="checkbox" value="Specialist medical practitioners"> Specialist medical practitioners</label>
          <label><input type="checkbox" value="Other"> Other</label>
        </td>
        <td><textarea data-notes="caregiver"></textarea></td>
      </tr>

      <!-- Row 3 -->
      <tr>
        <td><strong>Psychological & spiritual counselling for patients and caregivers</strong></td>
        <td class="chips" data-group="psych">
          <label><input type="checkbox" value="Community health workers"> Community health workers</label>
          <label><input type="checkbox" value="Paramedical professionals"> Paramedical professionals</label>
          <label><input type="checkbox" value="Nurses"> Nurses</label>
          <label><input type="checkbox" value="General medical practitioners"> General medical practitioners</label>
          <label><input type="checkbox" value="Specialist medical practitioners"> Specialist medical practitioners</label>
          <label><input type="checkbox" value="Other"> Other</label>
        </td>
        <td><textarea data-notes="psych"></textarea></td>
      </tr>

      <!-- Row 4 -->
      <tr>
        <td><strong>Provision of social support</strong></td>
        <td class="chips" data-group="social">
          <label><input type="checkbox" value="Community health workers"> Community health workers</label>
          <label><input type="checkbox" value="Paramedical professionals"> Paramedical professionals</label>
          <label><input type="checkbox" value="Nurses"> Nurses</label>
          <label><input type="checkbox" value="General medical practitioners"> General medical practitioners</label>
          <label><input type="checkbox" value="Specialist medical practitioners"> Specialist medical practitioners</label>
          <label><input type="checkbox" value="Other"> Other</label>
        </td>
        <td><textarea data-notes="social"></textarea></td>
      </tr>
    </table>

    <div class="actions">
      <button type="button" id="saveBtn">Save Answers</button>
      <button type="button" id="downloadBtn" style="display:none;">Download Answers</button>
    </div>
  </form>

  <script>
    const saveBtn = document.getElementById("saveBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    let savedText = "";

    saveBtn.addEventListener("click", () => {
      const rows = document.querySelectorAll("table tr");
      let output = "Your Reflection Notes\\n\\n";
      rows.forEach((row, i) => {
        if (i === 0) return; // skip header
        const action = row.querySelector("td:first-child").innerText.trim();
        const checkboxes = row.querySelectorAll("input[type=checkbox]:checked");
        const notes = row.querySelector("textarea")?.value.trim() || "";
        const selected = [...checkboxes].map(cb => cb.value).join(", ") || "None selected";

        output += `Action: ${action}\\nSelected: ${selected}\\nNotes: ${notes}\\n\\n`;
      });
      savedText = output;
      alert("Your answers have been saved. You can now download them.");
      downloadBtn.style.display = "inline-block";
    });

    downloadBtn.addEventListener("click", () => {
      const blob = new Blob([savedText], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "palliative_reflection.txt";
      link.click();
      URL.revokeObjectURL(link.href);
    });
  </script>
</body>
</html>
